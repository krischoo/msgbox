import{W as u}from"./webauthn-pnIkkuwh.js";var t={key_not_allowed:"The operation either timed out or was not allowed.",not_secured:"WebAuthn only supports secure connections. For testing over HTTP, you can use the origin 'localhost'.",not_supported:"Your browser doesn't currently support WebAuthn.",wrong_key:"The key is either incorrect or has been disabled in your account."};function s(e,o){switch(e){case"InvalidStateError":return t.key_not_allowed;case"NotAllowedError":return t.wrong_key;default:return o}}function r(e){document.getElementById("error").innerHTML=e,document.getElementById("error").classList.remove("hidden")}var n=new u((e,o)=>{r(s(e,o))});if(!n.webAuthnSupport())switch(n.notSupportedMessage()){case"not_secured":r(t.not_secured);break;case"not_supported":r(t.not_supported);break}/apple/i.test(navigator.vendor)||n.sign(publicKey,function(e){document.getElementById("success").classList.remove("hidden"),document.getElementById("id").value=e.id,document.getElementById("rawId").value=e.rawId,document.getElementById("authenticatorData").value=e.response.authenticatorData,document.getElementById("clientDataJSON").value=e.response.clientDataJSON,document.getElementById("signature").value=e.response.signature,document.getElementById("userHandle").value=e.response.userHandle,document.getElementById("type").value=e.type,document.getElementById("form").submit()});function d(){document.getElementById("error").classList.add("hidden"),n.sign(publicKey,function(e){document.getElementById("success").classList.remove("hidden"),document.getElementById("id").value=e.id,document.getElementById("rawId").value=e.rawId,document.getElementById("authenticatorData").value=e.response.authenticatorData,document.getElementById("clientDataJSON").value=e.response.clientDataJSON,document.getElementById("signature").value=e.response.signature,document.getElementById("userHandle").value=e.response.userHandle,document.getElementById("type").value=e.type,document.getElementById("form").submit()})}window.authenticateDevice=d;
