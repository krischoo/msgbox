import{W as u}from"./webauthn-pnIkkuwh.js";var r={key_already_used:"This key is already registered. It's not necessary to register it again.",key_not_allowed:"The operation either timed out or was not allowed.",not_secured:"WebAuthn only supports secure connections. For testing over HTTP, you can use the origin 'localhost'.",not_supported:"Your browser doesn't currently support WebAuthn."};let d=document.getElementById("form");d.addEventListener("keypress",function(e){e.key==="Enter"&&(e.preventDefault(),s())});function a(e,n){switch(e){case"InvalidStateError":return r.key_already_used;case"NotAllowedError":return r.key_not_allowed;default:return n}}function t(e){document.getElementById("error").innerHTML=e,document.getElementById("error").classList.remove("hidden")}var o=new u((e,n)=>{t(a(e,n))});if(!o.webAuthnSupport())switch(o.notSupportedMessage()){case"not_secured":t(r.not_secured);break;case"not_supported":t(r.not_supported);break}function s(){if(document.getElementById("error").classList.add("hidden"),document.getElementById("name").value==="")return t("A device name is required");if(document.getElementById("password").value==="")return t("Your current password is required");if(document.getElementById("name").value.length>50)return t("The device name may not be greater than 50 characters.");o.register(publicKey,function(e){document.getElementById("id").value=e.id,document.getElementById("rawId").value=e.rawId,document.getElementById("attestationObject").value=e.response.attestationObject,document.getElementById("clientDataJSON").value=e.response.clientDataJSON,document.getElementById("type").value=e.type,document.getElementById("form").submit()})}window.registerDevice=s;
